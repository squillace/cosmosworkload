2024-12-11T09:17:58.045432Z  WARN spin_trigger_http.handle_http_request{otel.kind="server" http.request.method=GET network.peer.address=127.0.0.1 network.peer.port=35192 network.protocol.name="http" url.path="/kv" url.query="Rajat=FANTASTIC" url.scheme="" http.route="/kv" otel.name="GET /kv" http.response.status_code=200}:spin_trigger_http.execute_wasm{otel.name="execute_wasm_component cosmosworkload"}:execute_wasi:spin_key_value.set{otel.kind="client"}: spin_factor_key_value::host: key-value error: Error { context: Full(Custom { kind: HttpResponse { status: Forbidden, error_code: Some("Forbidden") }, error: HttpError { status: Forbidden, details: ErrorDetails { code: Some("Forbidden"), message: Some("Message: {\"Errors\":[\"Request is blocked because principal [03510b3a-b399-4922-9c48-e728032424b0] does not have the required RBAC permissions to perform action [Microsoft.DocumentDB/databaseAccounts/sqlDatabases/containers/items/upsert] with OperationType [20] and ResourceType [2] on resource [dbs/spin/colls/keys-and-values]. Learn more: https://aka.ms/cosmos-native-rbac\"]}\r\nActivityId: bd6aa6ee-7540-4de8-8b27-df85dbd574c7, Request URI: /apps/268a8f8b-2b54-41ef-adf6-01953c532d50/services/b3089441-c13f-4a88-9c77-6f19e0166644/partitions/7a6bf99d-fbe5-46c4-889a-f5250815f1f1/replicas/133778649942510481p/, RequestStats: \r\nRequestStartTime: 2024-12-11T09:17:57.9892480Z, RequestEndTime: 2024-12-11T09:17:57.9905969Z,  Number of regions attempted:1\r\n{\"systemHistory\":[{\"dateUtc\":\"2024-12-11T09:17:04.5143569Z\",\"cpu\":2.738,\"memory\":410690024.000,\"threadInfo\":{\"isThreadStarving\":\"False\",\"threadWaitIntervalInMs\":0.0686,\"availableThreads\":32765,\"minThreads\":52,\"maxThreads\":32767},\"numberOfOpenTcpConnection\":461},{\"dateUtc\":\"2024-12-11T09:17:14.5247011Z\",\"cpu\":2.650,\"memory\":414116012.000,\"threadInfo\":{\"isThreadStarving\":\"False\",\"threadWaitIntervalInMs\":0.0355,\"availableThreads\":32765,\"minThreads\":52,\"maxThreads\":32767},\"numberOfOpenTcpConnection\":461},{\"dateUtc\":\"2024-12-11T09:17:24.5348074Z\",\"cpu\":1.528,\"memory\":414127756.000,\"threadInfo\":{\"isThreadStarving\":\"False\",\"threadWaitIntervalInMs\":0.0453,\"availableThreads\":32765,\"minThreads\":52,\"maxThreads\":32767},\"numberOfOpenTcpConnection\":461},{\"dateUtc\":\"2024-12-11T09:17:34.5452434Z\",\"cpu\":0.306,\"memory\":414097724.000,\"threadInfo\":{\"isThreadStarving\":\"False\",\"threadWaitIntervalInMs\":0.0949,\"availableThreads\":32757,\"minThreads\":52,\"maxThreads\":32767},\"numberOfOpenTcpConnection\":462},{\"dateUtc\":\"2024-12-11T09:17:44.5553643Z\",\"cpu\":0.531,\"memory\":413818052.000,\"threadInfo\":{\"isThreadStarving\":\"False\",\"threadWaitIntervalInMs\":0.0357,\"availableThreads\":32765,\"minThreads\":52,\"maxThreads\":32767},\"numberOfOpenTcpConnection\":462},{\"dateUtc\":\"2024-12-11T09:17:54.5656949Z\",\"cpu\":0.312,\"memory\":413835180.000,\"threadInfo\":{\"isThreadStarving\":\"False\",\"threadWaitIntervalInMs\":0.1847,\"availableThreads\":32765,\"minThreads\":52,\"maxThreads\":32767},\"numberOfOpenTcpConnection\":463}]}\r\nRequestStart: 2024-12-11T09:17:57.9893475Z; ResponseTime: 2024-12-11T09:17:57.9905969Z; StoreResult: StorePhysicalAddress: rntbd://cdb-ms-prod-westus1-be163.documents.azure.com:14416/apps/268a8f8b-2b54-41ef-adf6-01953c532d50/services/b3089441-c13f-4a88-9c77-6f19e0166644/partitions/7a6bf99d-fbe5-46c4-889a-f5250815f1f1/replicas/133778649942510481p/, LSN: 13, GlobalCommittedLsn: 13, PartitionKeyRangeId: , IsValid: True, StatusCode: 403, SubStatusCode: 5302, RequestCharge: 0, ItemLSN: -1, SessionToken: -1#13, UsingLocalLSN: False, TransportException: null, BELatencyMs: 0.345, ActivityId: bd6aa6ee-7540-4de8-8b27-df85dbd574c7, RetryAfterInMs: , ReplicaHealthStatuses: [(port: 14416 | status: Connected | lkt: 12/5/2024 11:41:25 AM)], TransportRequestTimeline: {\"requestTimeline\":[{\"event\": \"Created\", \"startTimeUtc\": \"2024-12-11T09:17:57.9893482Z\", \"durationInMs\": 0.0159},{\"event\": \"ChannelAcquisitionStarted\", \"startTimeUtc\": \"2024-12-11T09:17:57.9893641Z\", \"durationInMs\": 0.0113},{\"event\": \"Pipelined\", \"startTimeUtc\": \"2024-12-11T09:17:57.9893754Z\", \"durationInMs\": 0.092},{\"event\": \"Transit Time\", \"startTimeUtc\": \"2024-12-11T09:17:57.9894674Z\", \"durationInMs\": 0.9251},{\"event\": \"Received\", \"startTimeUtc\": \"2024-12-11T09:17:57.9903925Z\", \"durationInMs\": 0.0553},{\"event\": \"Completed\", \"startTimeUtc\": \"2024-12-11T09:17:57.9904478Z\", \"durationInMs\": 0}],\"serviceEndpointStats\":{\"inflightRequests\":1,\"openConnections\":1},\"connectionStats\":{\"waitforConnectionInit\":\"False\",\"callsPendingReceive\":0,\"lastSendAttempt\":\"2024-12-11T09:14:23.6441684Z\",\"lastSend\":\"2024-12-11T09:14:23.6442032Z\",\"lastReceive\":\"2024-12-11T09:14:23.6452812Z\"},\"requestSizeInBytes\":2110,\"requestBodySizeInBytes\":55,\"responseMetadataSizeInBytes\":173,\"responseBodySizeInBytes\":366};\r\n ResourceType: Document, OperationType: Upsert\r\n, SDK: Microsoft.Azure.Documents.Common/2.14.0") }, headers: Headers({HeaderName("x-ms-activity-id"): HeaderValue("bd6aa6ee-7540-4de8-8b27-df85dbd574c7"), HeaderName("content-type"): HeaderValue("application/json"), HeaderName("server"): HeaderValue("Microsoft-HTTPAPI/2.0"), HeaderName("x-ms-aad-applied-role-assignment"): HeaderValue(""), HeaderName("x-ms-substatus"): HeaderValue("5302"), HeaderName("x-ms-global-committed-lsn"): HeaderValue("13"), HeaderName("x-ms-number-of-read-regions"): HeaderValue("0"), HeaderName("x-ms-current-replica-set-size"): HeaderValue("4"), HeaderName("date"): HeaderValue("Wed, 11 Dec 2024 09:17:57 GMT"), HeaderName("x-ms-transport-request-id"): HeaderValue("2"), HeaderName("x-ms-request-duration-ms"): HeaderValue("0.345"), HeaderName("x-ms-serviceversion"): HeaderValue("version=2.14.0.0"), HeaderName("x-ms-last-state-change-utc"): HeaderValue("Thu, 05 Dec 2024 09:36:37.049 GMT"), HeaderName("x-ms-quorum-acked-lsn"): HeaderValue("13"), HeaderName("x-ms-cosmos-quorum-acked-llsn"): HeaderValue("13"), HeaderName("x-ms-gatewayversion"): HeaderValue("version=2.14.0"), HeaderName("lsn"): HeaderValue("13"), HeaderName("x-ms-cosmos-llsn"): HeaderValue("13"), HeaderName("x-ms-session-token"): HeaderValue("0:-1#13"), HeaderName("x-ms-schemaversion"): HeaderValue("1.18"), HeaderName("x-ms-cosmos-physical-partition-id"): HeaderValue("0"), HeaderName("x-ms-cosmos-internal-partition-id"): HeaderValue("7a6bf99d-fbe5-46c4-889a-f5250815f1f1"), HeaderName("strict-transport-security"): HeaderValue("max-age=31536000"), HeaderName("x-ms-xp-role"): HeaderValue("1"), HeaderName("x-ms-current-write-quorum"): HeaderValue("3"), HeaderName("transfer-encoding"): HeaderValue("chunked")}), body: b"{\"code\":\"Forbidden\",\"message\":\"Message: {\\\"Errors\\\":[\\\"Request is blocked because principal [03510b3a-b399-4922-9c48-e728032424b0] does not have the required RBAC permissions to perform action [Microsoft.DocumentDB/databaseAccounts/sqlDatabases/containers/items/upsert] with OperationType [20] and ResourceType [2] on resource [dbs/spin/colls/keys-and-values]. Learn more: https://aka.ms/cosmos-native-rbac\\\"]}\\r\\nActivityId: bd6aa6ee-7540-4de8-8b27-df85dbd574c7, Request URI: /apps/268a8f8b-2b54-41ef-adf6-01953c532d50/services/b3089441-c13f-4a88-9c77-6f19e0166644/partitions/7a6bf99d-fbe5-46c4-889a-f5250815f1f1/replicas/133778649942510481p/, RequestStats: \\r\\nRequestStartTime: 2024-12-11T09:17:57.9892480Z, RequestEndTime: 2024-12-11T09:17:57.9905969Z,  Number of regions attempted:1\\r\\n{\\\"systemHistory\\\":[{\\\"dateUtc\\\":\\\"2024-12-11T09:17:04.5143569Z\\\",\\\"cpu\\\":2.738,\\\"memory\\\":410690024.000,\\\"threadInfo\\\":{\\\"isThreadStarving\\\":\\\"False\\\",\\\"threadWaitIntervalInMs\\\":0.0686,\\\"availableThreads\\\":32765,\\\"minThreads\\\":52,\\\"maxThreads\\\":32767},\\\"numberOfOpenTcpConnection\\\":461},{\\\"dateUtc\\\":\\\"2024-12-11T09:17:14.5247011Z\\\",\\\"cpu\\\":2.650,\\\"memory\\\":414116012.000,\\\"threadInfo\\\":{\\\"isThreadStarving\\\":\\\"False\\\",\\\"threadWaitIntervalInMs\\\":0.0355,\\\"availableThreads\\\":32765,\\\"minThreads\\\":52,\\\"maxThreads\\\":32767},\\\"numberOfOpenTcpConnection\\\":461},{\\\"dateUtc\\\":\\\"2024-12-11T09:17:24.5348074Z\\\",\\\"cpu\\\":1.528,\\\"memory\\\":414127756.000,\\\"threadInfo\\\":{\\\"isThreadStarving\\\":\\\"False\\\",\\\"threadWaitIntervalInMs\\\":0.0453,\\\"availableThreads\\\":32765,\\\"minThreads\\\":52,\\\"maxThreads\\\":32767},\\\"numberOfOpenTcpConnection\\\":461},{\\\"dateUtc\\\":\\\"2024-12-11T09:17:34.5452434Z\\\",\\\"cpu\\\":0.306,\\\"memory\\\":414097724.000,\\\"threadInfo\\\":{\\\"isThreadStarving\\\":\\\"False\\\",\\\"threadWaitIntervalInMs\\\":0.0949,\\\"availableThreads\\\":32757,\\\"minThreads\\\":52,\\\"maxThreads\\\":32767},\\\"numberOfOpenTcpConnection\\\":462},{\\\"dateUtc\\\":\\\"2024-12-11T09:17:44.5553643Z\\\",\\\"cpu\\\":0.531,\\\"memory\\\":413818052.000,\\\"threadInfo\\\":{\\\"isThreadStarving\\\":\\\"False\\\",\\\"threadWaitIntervalInMs\\\":0.0357,\\\"availableThreads\\\":32765,\\\"minThreads\\\":52,\\\"maxThreads\\\":32767},\\\"numberOfOpenTcpConnection\\\":462},{\\\"dateUtc\\\":\\\"2024-12-11T09:17:54.5656949Z\\\",\\\"cpu\\\":0.312,\\\"memory\\\":413835180.000,\\\"threadInfo\\\":{\\\"isThreadStarving\\\":\\\"False\\\",\\\"threadWaitIntervalInMs\\\":0.1847,\\\"availableThreads\\\":32765,\\\"minThreads\\\":52,\\\"maxThreads\\\":32767},\\\"numberOfOpenTcpConnection\\\":463}]}\\r\\nRequestStart: 2024-12-11T09:17:57.9893475Z; ResponseTime: 2024-12-11T09:17:57.9905969Z; StoreResult: StorePhysicalAddress: rntbd://cdb-ms-prod-westus1-be163.documents.azure.com:14416/apps/268a8f8b-2b54-41ef-adf6-01953c532d50/services/b3089441-c13f-4a88-9c77-6f19e0166644/partitions/7a6bf99d-fbe5-46c4-889a-f5250815f1f1/replicas/133778649942510481p/, LSN: 13, GlobalCommittedLsn: 13, PartitionKeyRangeId: , IsValid: True, StatusCode: 403, SubStatusCode: 5302, RequestCharge: 0, ItemLSN: -1, SessionToken: -1#13, UsingLocalLSN: False, TransportException: null, BELatencyMs: 0.345, ActivityId: bd6aa6ee-7540-4de8-8b27-df85dbd574c7, RetryAfterInMs: , ReplicaHealthStatuses: [(port: 14416 | status: Connected | lkt: 12/5/2024 11:41:25 AM)], TransportRequestTimeline: {\\\"requestTimeline\\\":[{\\\"event\\\": \\\"Created\\\", \\\"startTimeUtc\\\": \\\"2024-12-11T09:17:57.9893482Z\\\", \\\"durationInMs\\\": 0.0159},{\\\"event\\\": \\\"ChannelAcquisitionStarted\\\", \\\"startTimeUtc\\\": \\\"2024-12-11T09:17:57.9893641Z\\\", \\\"durationInMs\\\": 0.0113},{\\\"event\\\": \\\"Pipelined\\\", \\\"startTimeUtc\\\": \\\"2024-12-11T09:17:57.9893754Z\\\", \\\"durationInMs\\\": 0.092},{\\\"event\\\": \\\"Transit Time\\\", \\\"startTimeUtc\\\": \\\"2024-12-11T09:17:57.9894674Z\\\", \\\"durationInMs\\\": 0.9251},{\\\"event\\\": \\\"Received\\\", \\\"startTimeUtc\\\": \\\"2024-12-11T09:17:57.9903925Z\\\", \\\"durationInMs\\\": 0.0553},{\\\"event\\\": \\\"Completed\\\", \\\"startTimeUtc\\\": \\\"2024-12-11T09:17:57.9904478Z\\\", \\\"durationInMs\\\": 0}],\\\"serviceEndpointStats\\\":{\\\"inflightRequests\\\":1,\\\"openConnections\\\":1},\\\"connectionStats\\\":{\\\"waitforConnectionInit\\\":\\\"False\\\",\\\"callsPendingReceive\\\":0,\\\"lastSendAttempt\\\":\\\"2024-12-11T09:14:23.6441684Z\\\",\\\"lastSend\\\":\\\"2024-12-11T09:14:23.6442032Z\\\",\\\"lastReceive\\\":\\\"2024-12-11T09:14:23.6452812Z\\\"},\\\"requestSizeInBytes\\\":2110,\\\"requestBodySizeInBytes\\\":55,\\\"responseMetadataSizeInBytes\\\":173,\\\"responseBodySizeInBytes\\\":366};\\r\\n ResourceType: Document, OperationType: Upsert\\r\\n, SDK: Microsoft.Azure.Documents.Common/2.14.0\"}" } }, "server returned error status which will not be retried: 403") }